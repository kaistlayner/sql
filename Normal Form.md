# 정규화를 하는 이유
- 데이터 중복을 최소화 (저장 공간 효율)
- DB 변경 시 이상 현상 제거
    - 삽입, 삭제, 수정 시 테이블 재구성의 필요성 감소
    - CUD 하기가 쉬움 => 오류를 적게 범함

<br>

- 읽는 시간이 느림 (JOIN이 많음)
- 기술적 비용이 많이 듬 (긴 쿼리)

<br>

# 비정규화를 하는 이유
- 읽는 시간이 빠름 (JOIN이 적음)
- 기술적 비용도 적음 (쿼리가 짧음)

<br>

- 갱신 삽입하기 힘듬
- 저장공간이 많이 듬
- 일관성이 깨짐 (옳은 값인지 검증하기 힘듬)

<br>

# 정규화의 방향성
1. 정보의 손실은 없어야 한다. (무손실)
2. 하나의 독립된 관계성은 하나의 독립된 Relation으로 분리해야 한다.
3. 데이터의 반복을 줄인다.

<br>

# 이상 현상(anomaly) 제거
### 예시 표
|이름|강의명|전화번호|
|-|-|-|
|허재영|일반물리학|010-5678-9012|
|조민준|일반물리학|010-1234-5678|
|조민준|미적분학|010-1234-5678|

<br>

### 삽입 이상 (Create)
> 의도하지 않은 속성(attribute)까지 삽입해야만 자료를 테이블에 추가 가능  
ex) 강의를 듣지 않는 학생은 테이블에 추가 불가

<br>

### 갱신 이상 (Update)
> 중복된 데이터 중 일부만 수정되어 이후 문제가 발생  
ex) 일반물리학을 듣는 조민준 학생의 전화번호를 수정 => 미적분학을 듣는 조민준의 전화번호 미수정

<br>

### 삭제 이상 (Delete)
> 필요 없는 데이터 삭제 시, 필요한 다른 정보까지 같이 삭제  
ex) 일반물리학에 관한 정보를 삭제 => 허재영 학생의 정보가 삭제됨

<br>

# 용어 설명
### 함수 종속성
> B가 A에 함수 종속 === A -> B (N : 1)  
A를 알면 B의 값을 식별 가능 (A는 결정자)  
B가 변하면 A도 변함 (B는 종속자)

<br>

### 완전 함수 종속
> 결정자 = 기본키(PK) 전체

<br>

### 부분 함수 종속
> 결정자 = 기본키(PK)의 일부 or 기본키(PK)가 아닌 속성(attribute)에 종속

<br>

### 이행적 함수 종속
> X->Y, Y->Z일 때 X->Z  
X가 결정되면, Y를 통해 결국 Z도 결정

<br>

### 다치 종속
> A->>B  
A가 결정되면 여러 개의 B가 결정됨  
A가 B를 다치 결정 === B가 A에 다치 종속

<br>

### 조인 종속
> 테이블 T의 임의의 속성(attribute) (a, b, c)를 선택  
(a, b), (b, c), (a, c)에 대해 테이블 T를 projection한 테이블 Tab, Tbc, Tac  
**Tab JOIN Tbc JOIN Tac === T** 이면 조인 종속

<br>

# 1NF
모든 속성(attribute)은 하나의 원자값(Atomic value)만 갖는다.

### before
|*이름|취미|
|-|-|
|조민준|독서, 코딩|
### after
|이름|취미|
|-|-|
|조민준|독서|
|조민준|코딩|

<br>

# 2NF
모든 속성(attribute)은 <u>**모든 기본키(PK)**</u>에 종속된다.

<img src='./img/normalize/2정규화.jpg' height=200>

### before

|*강의명|*학번|이름|성적
|-|-|-|-|
|CS101|20160123|조민준|A+
|CS201|20160123|조민준|B-
> 이름이 학번(PK의 일부)에 종속

<br>

### after
|*강의명|학번|성적|
|-|-|-|
|CS101|20160123|A+
|CS201|20160123|B-

|*학번|이름|
|-|-|
|20160123|조민준|

<br>

# 3NF
[이행적 함수종속](#이행적-함수-종속)이 없어야 한다. or 모든 속성(attribute)은 기본키(PK)가 아닌 값에 종속성을 가지면 안된다.

<img src='./img/normalize/3정규화.jpg' height=200>

### before
|*학번|이름|학과|학과번호|
|-|-|-|-|
|20160123|조민준|전산학과|ASD123|
>  학번 -> 학과 -> 학과번호

<br>

### after
|*학번|이름|학과|
|-|-|-|
|20160123|조민준|전산학과|

|*학과|학과번호|
|-|-|
|전산학과|ASD123|

<br>

# BCNF (Boyce-Codd Normal Form)
기본키가 아닌 속성이 기본키를 결정하면 안된다. (1974년 Raymond Boyce와 Edgar Codd가 만든 데이터베이스 정규화)

<img src='./img/normalize/BCNF.jpg' height=200>

### before
|*학생|*특강|교수|성적|
|-|-|-|-|
|조민준|컴퓨터 비전을 위한 기계학습|김교수|C+|
|허재영|컴퓨터 비전을 위한 기계학습|김교수|A0|
|정명구|컴퓨터 비전을 위한 기계학습|박교수|A+|
|정명구|지능로봇공학 개론|이교수|A-|
|양문영|계산 학습 이론|강교수|B+|
> 교수 한명은 특강 하나만 가능하다고 가정,  
교수가 특강을 결정 (교수 -> 특강)

<br>

### after
|*학생|*교수|성적|
|-|-|-|
|조민준|김교수|C+|
|허재영|김교수|A0|
|정명구|박교수|A+|
|정명구|이교수|A-|
|양문영|강교수|B+|

|*교수|특강|
|-|-|
|김교수|컴퓨터 비전을 위한 기계학습|
|박교수|컴퓨터 비전을 위한 기계학습|
|이교수|지능로봇공학 개론|
|강교수|계산 학습 이론|

<br>

# 4NF
[다치종속](#다치-종속) 관계인 A->>B가 존재할 때, R의 모든 속성도 A에 [함수 종속](#완전-함수-종속)이어야 한다.

<img src='./img/normalize/4정규화.jpg' height=100>

### before
|강의명|*교수|*교재|
|-|-|-|
|스페인어 회화|김교수|클린코드|
|스페인어 회화|김교수|SQL 안티패턴|
|스페인어 회화|강교수|클린코드|
|스페인어 회화|강교수|SQL 안티패턴|
|운영체제 및 실험|박교수|디자인 패턴|
|운영체제 및 실험|박교수|Interactive Developer|
> 강의명이 여러 교수, 여러 교재를 결정

<br>

### after
|강의명|*교수|
|-|-|
|스페인어 회화|김교수|
|스페인어 회화|강교수|
|운영체제 및 실험|박교수|

|강의명|*교재|
|-|-|
|스페인어 회화|클린코드|
|스페인어 회화|SQL 안티패턴|
|운영체제 및 실험|디자인 패턴|
|운영체제 및 실험|Interactive Developer|

<br>

# 5NF (Project Join Normal Form)
[조인 종속](#조인-종속)이 없어야 한다. (더 이상 분해 불가능 하도록)

<img src='./img/normalize/5정규화.jpg' height=100>

### before
|강의 중인 강좌|교수|*추천 도서|
|-|-|-|
|프로그래밍 언어|김교수|클린코드|
|프로그래밍 언어|김교수|SQL 안티패턴|
|프로그래밍 언어|박교수|nodejs 교과서|
|프로그래밍 언어|박교수|클린 아키택처|
|운영체제 및 실험|김교수|디자인 패턴|
|운영체제 및 실험|김교수|Interactive Developer|
>

<br>

### after
|강의 중인 강좌|교수|
|-|-|
|프로그래밍 언어|김교수|
|프로그래밍 언어|박교수|
|운영체제 및 실험|김교수|

|교수|*추천 도서|
|-|-|
|김교수|클린코드|
|김교수|SQL 안티패턴|
|박교수|nodejs 교과서|
|박교수|클린 아키택처|
|김교수|디자인 패턴|
|김교수|Interactive Developer|

|강의 중인 강좌|*추천 도서|
|-|-|
|프로그래밍 언어|클린코드|
|프로그래밍 언어|SQL 안티패턴|
|프로그래밍 언어|nodejs 교과서|
|프로그래밍 언어|클린 아키택처|
|운영체제 및 실험|디자인 패턴|
|운영체제 및 실험|Interactive Developer|

<br>

# 관계도 정리
<img src='./img/normalize/정규화.jpg' height=1000>

<br>

# 읽을 거리
1. Microsoft 1~3 정규화 설명 (영문)  
https://docs.microsoft.com/en-US/office/troubleshoot/access/database-normalization-description
2. Database 1~3 정규화 in SQL (영문)  
https://www.sqlservercentral.com/articles/database-normalization-in-sql-with-examples
3. 1~5 정규화 설명 블로그  
https://untitledtblog.tistory.com/128

<br>

# 여담
너무 많은 정규화는 JOIN으로 인해 성능이 저하될 수 있다고 한다. ~~보통 3NF까지 진행한다고..~~
